(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[331],{20120:(e,s,t)=>{"use strict";t.d(s,{$v:()=>j,EO:()=>x,Lt:()=>i,Rx:()=>f,Zr:()=>g,ck:()=>h,r7:()=>p,tv:()=>c,wd:()=>u});var a=t(95155),r=t(12115),l=t(52498),n=t(25016),d=t(97003);let i=l.bL,c=l.l9,o=l.ZL,m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:s})});m.displayName=l.hJ.displayName;let x=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsxs)(o,{children:[(0,a.jsx)(m,{}),(0,a.jsx)(l.UC,{ref:s,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r})]})});x.displayName=l.UC.displayName;let u=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};u.displayName="AlertDialogHeader";let h=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};h.displayName="AlertDialogFooter";let p=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.hE,{ref:s,className:(0,n.cn)("text-lg font-semibold",t),...r})});p.displayName=l.hE.displayName;let j=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.VY,{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...r})});j.displayName=l.VY.displayName;let f=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.rc,{ref:s,className:(0,n.cn)((0,d.r)(),t),...r})});f.displayName=l.rc.displayName;let g=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.ZD,{ref:s,className:(0,n.cn)((0,d.r)({variant:"outline"}),"mt-2 sm:mt-0",t),...r})});g.displayName=l.ZD.displayName},35982:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ep});var a=t(95155),r=t(12115),l=t(20063),n=t(52619),d=t.n(n),i=t(95604),c=t(35626),o=t(69086),m=t(39867),x=t(63581),u=t(35299),h=t(97003),p=t(83209),j=t(47507),f=t(6132),g=t(89715),N=t(57828),v=t(42529),y=t(78874),b=t(18514),w=t(96633),C=t(38162),A=t(5917),S=t(25016);let E=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(C.bL,{ref:s,className:(0,S.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:(0,a.jsx)(C.C1,{className:(0,S.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(A.A,{className:"h-4 w-4"})})})});E.displayName=C.bL.displayName;var R=t(68122),k=t(87627),F=t(31123),T=t(81449),_=t(67374),I=t(44090),P=t(66020);function O(e){let{filters:s,onSelectionChange:t}=e,{data:l,isLoading:n,error:c,refetch:o}=(0,I.Ug)(s),[m,x]=(0,r.useState)(new Set),[u,p]=(0,r.useState)(null),[j,C]=(0,r.useState)(null),[A,O]=(0,r.useState)(null),L=(0,i.useTranslations)("records"),z=(0,i.useTranslations)("type"),D=(0,i.useTranslations)("common"),$=()=>{o()};if(n)return(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsx)(R.E,{className:"h-16 w-full"},s))});if(c)return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,a.jsx)(f.A,{className:"h-12 w-12 text-destructive mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:D("error")}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:D("error")}),(0,a.jsx)(h.$,{onClick:()=>o(),children:D("retry")})]});let G=(null==l?void 0:l.records)||[];if(0===G.length)return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,a.jsx)(g.A,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:L("noRecordsFound")}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:L("noRecordsMessage")}),(0,a.jsx)(h.$,{asChild:!0,children:(0,a.jsx)(d(),{href:"/extraction",children:L("goToExtraction")})})]});let J=G.every(e=>m.has(e.id)),q=G.some(e=>m.has(e.id))&&!J;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(w.XI,{children:[(0,a.jsx)(w.A0,{children:(0,a.jsxs)(w.Hj,{children:[(0,a.jsx)(w.nd,{className:"w-12",children:(0,a.jsx)(E,{checked:J,ref:e=>{e&&(e.indeterminate=q)},onCheckedChange:e=>{if(e){let e=new Set((null==l?void 0:l.records.map(e=>e.id))||[]);x(e),null==t||t(Array.from(e))}else x(new Set),null==t||t([])}})}),(0,a.jsx)(w.nd,{children:L("sourceFile")}),(0,a.jsx)(w.nd,{children:L("type")}),(0,a.jsx)(w.nd,{children:L("status")}),(0,a.jsx)(w.nd,{children:L("confidence")}),(0,a.jsx)(w.nd,{children:L("created")}),(0,a.jsx)(w.nd,{className:"text-right",children:L("actions")})]})}),(0,a.jsx)(w.BF,{children:G.map(e=>{var s;return(0,a.jsxs)(w.Hj,{children:[(0,a.jsx)(w.nA,{children:(0,a.jsx)(E,{checked:m.has(e.id),onCheckedChange:s=>((e,s)=>{let a=new Set(m);s?a.add(e):a.delete(e),x(a),null==t||t(Array.from(a))})(e.id,!!s)})}),(0,a.jsx)(w.nA,{className:"font-medium",children:(0,a.jsx)(d(),{href:"/records/".concat(e.id),className:"hover:underline",children:(0,S.e7)(e.extraction.source_file)})}),(0,a.jsx)(w.nA,{children:(s=e.extraction.record_type,({[P.ee.FORM]:z("form"),[P.ee.EMAIL]:z("email"),[P.ee.INVOICE]:z("invoice")})[s]||s)}),(0,a.jsx)(w.nA,{children:(0,a.jsx)(k.W,{status:e.status})}),(0,a.jsxs)(w.nA,{children:[Math.round(100*e.extraction.confidence_score),"%"]}),(0,a.jsx)(w.nA,{children:(0,S.Yq)(e.created_at)}),(0,a.jsx)(w.nA,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end gap-1",children:[(0,a.jsx)(h.$,{variant:"ghost",size:"icon",asChild:!0,title:"View Details",children:(0,a.jsx)(d(),{href:"/records/".concat(e.id),children:(0,a.jsx)(N.A,{className:"h-4 w-4"})})}),(e.status===P.kY.PENDING||e.status===P.kY.EDITED)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.$,{variant:"ghost",size:"icon",onClick:()=>p(e.id),title:L("approve"),children:(0,a.jsx)(v.A,{className:"h-4 w-4 text-green-600"})}),(0,a.jsx)(h.$,{variant:"ghost",size:"icon",onClick:()=>C(e.id),title:L("reject"),children:(0,a.jsx)(y.A,{className:"h-4 w-4 text-red-600"})}),(0,a.jsx)(h.$,{variant:"ghost",size:"icon",onClick:()=>O(e),title:D("edit"),children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})]})]})})]},e.id)})})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-4",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:L("showingRecords",{shown:G.length,total:(null==l?void 0:l.total)||0})}),(null==l?void 0:l.has_more)&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:L("moreAvailable")})]}),u&&(0,a.jsx)(F.U,{recordId:u,isOpen:!!u,onClose:()=>p(null),onSuccess:$}),j&&(0,a.jsx)(T.O,{recordId:j,isOpen:!!j,onClose:()=>C(null),onSuccess:$}),A&&(0,a.jsx)(_.R,{record:A,isOpen:!!A,onClose:()=>O(null),onSuccess:$})]})}var L=t(20120),z=t(67001),D=t(90235),$=t(48548),G=t(73959);function J(e){let{selectedIds:s,onComplete:t,onExportPrompt:l}=e,[n,d]=(0,r.useState)(!1),[i,c]=(0,r.useState)(!1),[o,m]=(0,r.useState)(""),[x,p]=(0,r.useState)(""),{toast:j}=(0,G.dj)(),f=(0,$.Ld)(),g=(0,$.zQ)(),N=async()=>{try{var e;let a=await f.mutateAsync({ids:s,notes:o||void 0});j({title:"Batch Approval Complete",description:"".concat(a.approved_count," records approved."),variant:"success"}),a.error_count&&a.error_count>0&&j({title:"Some Records Failed",description:"".concat(a.error_count," records could not be approved."),variant:"destructive"}),d(!1),m(""),t();let r=null!=(e=a.approved_count)?e:0;r>0&&l&&setTimeout(()=>{l(r)},500)}catch(e){j({title:"Batch Approval Failed",description:"An error occurred during batch approval.",variant:"destructive"})}},b=async()=>{if(!x.trim())return void j({title:"Reason Required",description:"Please provide a reason for rejection.",variant:"destructive"});try{let e=await g.mutateAsync({ids:s,reason:x});j({title:"Batch Rejection Complete",description:"".concat(e.rejected_count," records rejected.")}),e.error_count&&e.error_count>0&&j({title:"Some Records Failed",description:"".concat(e.error_count," records could not be rejected."),variant:"destructive"}),c(!1),p(""),t()}catch(e){j({title:"Batch Rejection Failed",description:"An error occurred during batch rejection.",variant:"destructive"})}};return 0===s.length?null:(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-lg border bg-muted/50 p-4",children:[(0,a.jsxs)("span",{className:"text-sm font-medium",children:[s.length," record",1!==s.length?"s":""," selected"]}),(0,a.jsxs)("div",{className:"ml-auto flex gap-2",children:[(0,a.jsxs)(h.$,{variant:"success",size:"sm",onClick:()=>d(!0),children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Approve All"]}),(0,a.jsxs)(h.$,{variant:"destructive",size:"sm",onClick:()=>c(!0),children:[(0,a.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Reject All"]})]}),(0,a.jsx)(L.Lt,{open:n,onOpenChange:d,children:(0,a.jsxs)(L.EO,{children:[(0,a.jsxs)(L.wd,{children:[(0,a.jsxs)(L.r7,{children:["Approve ",s.length," Records?"]}),(0,a.jsx)(L.$v,{children:"This will approve all selected records and make them ready for export."})]}),(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsx)(D.J,{htmlFor:"batch-notes",children:"Notes (optional)"}),(0,a.jsx)(z.T,{id:"batch-notes",placeholder:"Add notes for all approved records...",value:o,onChange:e=>m(e.target.value),className:"mt-2",rows:3})]}),(0,a.jsxs)(L.ck,{children:[(0,a.jsx)(L.Zr,{disabled:f.isPending,children:"Cancel"}),(0,a.jsxs)(L.Rx,{onClick:e=>{e.preventDefault(),N()},disabled:f.isPending,className:"bg-green-600 hover:bg-green-700",children:[f.isPending?(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Approve All"]})]})]})}),(0,a.jsx)(L.Lt,{open:i,onOpenChange:c,children:(0,a.jsxs)(L.EO,{children:[(0,a.jsxs)(L.wd,{children:[(0,a.jsxs)(L.r7,{children:["Reject ",s.length," Records?"]}),(0,a.jsx)(L.$v,{children:"This will reject all selected records. They will not be included in exports."})]}),(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsxs)(D.J,{htmlFor:"batch-reason",children:["Rejection Reason ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)(z.T,{id:"batch-reason",placeholder:"Reason for rejecting all selected records...",value:x,onChange:e=>p(e.target.value),className:"mt-2",rows:3,required:!0})]}),(0,a.jsxs)(L.ck,{children:[(0,a.jsx)(L.Zr,{disabled:g.isPending,children:"Cancel"}),(0,a.jsxs)(L.Rx,{onClick:e=>{e.preventDefault(),b()},disabled:g.isPending||!x.trim(),className:"bg-red-600 hover:bg-red-700",children:[g.isPending?(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Reject All"]})]})]})})]})}var q=t(54679),M=t(24722),Y=t(35202);let U=[{value:"csv",label:"CSV",description:"Comma-separated values",icon:g.A},{value:"xlsx",label:"Excel",description:"Microsoft Excel format",icon:M.A},{value:"json",label:"JSON",description:"JavaScript Object Notation",icon:Y.A}];function V(e){let{value:s,onChange:t}=e;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(D.J,{children:"Export Format"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-3",children:U.map(e=>{let r=s===e.value;return(0,a.jsxs)("button",{type:"button",onClick:()=>t(e.value),className:(0,S.cn)("flex flex-col items-center rounded-lg border-2 p-4 transition-colors",r?"border-primary bg-primary/5":"border-muted hover:border-primary/50"),children:[(0,a.jsx)(e.icon,{className:(0,S.cn)("h-8 w-8 mb-2",r?"text-primary":"text-muted-foreground")}),(0,a.jsx)("span",{className:(0,S.cn)("font-medium",r?"text-primary":"text-foreground"),children:e.label}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.description})]},e.value)})})]})}function Z(e){let{isOpen:s,onClose:t,preselectedIds:l}=e,[n,d]=(0,r.useState)("csv"),[i,c]=(0,r.useState)(!1),{toast:o}=(0,G.dj)(),x=(0,$.iL)(),p=async()=>{try{await x.mutateAsync({record_ids:l,format:n,include_rejected:i}),o({title:"Export Complete",description:"Records exported as ".concat(n.toUpperCase()," file."),variant:"success"}),t()}catch(e){o({title:"Export Failed",description:"Failed to export records. Please try again.",variant:"destructive"})}};return(0,a.jsx)(q.lG,{open:s,onOpenChange:e=>!e&&t(),children:(0,a.jsxs)(q.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(q.c7,{children:[(0,a.jsxs)(q.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(m.A,{className:"h-5 w-5"}),"Export Records"]}),(0,a.jsx)(q.rr,{children:l&&l.length>0?"Export ".concat(l.length," selected records"):"Export all approved and edited records"})]}),(0,a.jsxs)("div",{className:"space-y-6 py-4",children:[(0,a.jsx)(V,{value:n,onChange:d}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(E,{id:"include-rejected",checked:i,onCheckedChange:e=>c(!!e)}),(0,a.jsx)(D.J,{htmlFor:"include-rejected",className:"text-sm font-normal cursor-pointer",children:"Include rejected records"})]}),!l&&(0,a.jsx)("div",{className:"rounded-lg border bg-muted/50 p-4 text-sm text-muted-foreground",children:(0,a.jsxs)("p",{children:["By default, only ",(0,a.jsx)("strong",{children:"approved"})," and"," ",(0,a.jsx)("strong",{children:"edited"})," records will be exported. Pending records must be reviewed first."]})})]}),(0,a.jsxs)(q.Es,{children:[(0,a.jsx)(h.$,{variant:"outline",onClick:t,disabled:x.isPending,children:"Cancel"}),(0,a.jsxs)(h.$,{onClick:p,disabled:x.isPending,children:[x.isPending?(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Export"]})]})]})})}var B=t(99776),H=t(22454),W=t(80549),X=t(61362),K=t(89559),Q=t(6191),ee=t(93499),es=t(33789),et=t(22320);function ea(e){var s;let{isOpen:t,onClose:l}=e,{toast:n}=(0,G.dj)(),d=(0,B.jE)(),[i,c]=(0,r.useState)(""),[m,x]=(0,r.useState)(""),[p,j]=(0,r.useState)(""),[g,N]=(0,r.useState)(!1),[v,y]=(0,r.useState)("sync"),{data:b,isLoading:w}=(0,H.I)({queryKey:["google-sheets-status"],queryFn:et.yz,enabled:t}),C=(0,W.n)({mutationFn:e=>(0,et.uw)(e),onSuccess:e=>{c(e.spreadsheet_id),x(e.spreadsheet_url),y("sync"),n({title:"Spreadsheet Created",description:'Created "'.concat(e.title,'". You can now sync your data.')})},onError:e=>{n({title:"Creation Failed",description:e.message,variant:"destructive"})}}),A=(0,W.n)({mutationFn:()=>(0,et.c1)(i,g),onSuccess:e=>{x(e.spreadsheet_url),d.invalidateQueries({queryKey:["records"]}),n({title:"Sync Complete",description:"Successfully synced ".concat(e.synced," records to Google Sheets.")})},onError:e=>{n({title:"Sync Failed",description:e.message,variant:"destructive"})}});(0,r.useEffect)(()=>{let e=localStorage.getItem("techflow-spreadsheet-id");e&&c(e)},[]),(0,r.useEffect)(()=>{i&&localStorage.setItem("techflow-spreadsheet-id",i)},[i]);let S=C.isPending||A.isPending;if(w)return(0,a.jsx)(q.lG,{open:t,onOpenChange:l,children:(0,a.jsxs)(q.Cf,{children:[(0,a.jsx)(q.c7,{children:(0,a.jsx)(q.L3,{className:"sr-only",children:"Loading Google Sheets Status"})}),(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(u.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]})});let R=null!=(s=null==b?void 0:b.configured)&&s;return(0,a.jsx)(q.lG,{open:t,onOpenChange:l,children:(0,a.jsxs)(q.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(q.c7,{children:[(0,a.jsxs)(q.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(o.A,{className:"h-5 w-5 text-green-600"}),"Google Sheets Integration"]}),(0,a.jsx)(q.rr,{children:"Sync your extraction records to Google Sheets for centralized data management."})]}),R?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[(0,a.jsx)(X.A,{className:"h-4 w-4"}),"Google Sheets integration is configured"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(h.$,{variant:"sync"===v?"default":"outline",size:"sm",onClick:()=>y("sync"),children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-1"}),"Sync to Existing"]}),(0,a.jsxs)(h.$,{variant:"create"===v?"default":"outline",size:"sm",onClick:()=>y("create"),children:[(0,a.jsx)(Q.A,{className:"h-4 w-4 mr-1"}),"Create New"]})]}),"create"===v?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(D.J,{htmlFor:"title",children:"Spreadsheet Title (optional)"}),(0,a.jsx)(es.p,{id:"title",placeholder:"TechFlow Extractions",value:p,onChange:e=>j(e.target.value)})]}),(0,a.jsx)(h.$,{onClick:()=>{C.mutate(p||void 0)},disabled:S,className:"w-full",children:C.isPending?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Q.A,{className:"h-4 w-4 mr-2"}),"Create Spreadsheet"]})})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(D.J,{htmlFor:"spreadsheet-id",children:"Spreadsheet ID"}),(0,a.jsx)(es.p,{id:"spreadsheet-id",placeholder:"Enter spreadsheet ID...",value:i,onChange:e=>c(e.target.value)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Find the ID in the spreadsheet URL: docs.google.com/spreadsheets/d/",(0,a.jsx)("strong",{children:"[ID]"}),"/edit"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(E,{id:"include-rejected",checked:g,onCheckedChange:e=>N(!0===e)}),(0,a.jsx)(D.J,{htmlFor:"include-rejected",className:"text-sm font-normal",children:"Include rejected records"})]}),(0,a.jsx)(h.$,{onClick:()=>{if(!i)return void n({title:"No Spreadsheet",description:"Please enter a spreadsheet ID or create a new one.",variant:"destructive"});A.mutate()},disabled:S||!i,className:"w-full",children:A.isPending?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Syncing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-2"}),"Sync Records"]})})]}),m&&(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-lg border bg-muted/50 p-3",children:[(0,a.jsx)("span",{className:"text-sm",children:"Open Spreadsheet"}),(0,a.jsx)(h.$,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsxs)("a",{href:m,target:"_blank",rel:"noopener noreferrer",children:[(0,a.jsx)(ee.A,{className:"h-4 w-4 mr-1"}),"Open"]})})]})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 rounded-lg border border-yellow-200 bg-yellow-50 p-4",children:[(0,a.jsx)(f.A,{className:"h-5 w-5 text-yellow-600 shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("p",{className:"font-medium text-yellow-800",children:"Not Configured"}),(0,a.jsx)("p",{className:"text-yellow-700 mt-1",children:"Google Sheets integration requires setup. To enable:"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside mt-2 text-yellow-700 space-y-1",children:[(0,a.jsx)("li",{children:"Create a Google Cloud project"}),(0,a.jsx)("li",{children:"Enable Google Sheets API"}),(0,a.jsx)("li",{children:"Create a Service Account"}),(0,a.jsx)("li",{children:"Download credentials JSON"}),(0,a.jsx)("li",{children:"Set GOOGLE_CREDENTIALS_PATH env variable"})]})]})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Alternatively, use the ",(0,a.jsx)("strong",{children:"Export"})," feature to download your data as CSV or Excel."]})]})]})})}var er=t(15870),el=t(79158),en=t(97450),ed=t(24058),ei=t(99051);let ec=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(ed.bL,{className:(0,S.cn)("grid gap-2",t),...r,ref:s})});ec.displayName=ed.bL.displayName;let eo=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(ed.q7,{ref:s,className:(0,S.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:(0,a.jsx)(ed.C1,{className:"flex items-center justify-center",children:(0,a.jsx)(ei.A,{className:"h-2.5 w-2.5 fill-current text-current"})})})});eo.displayName=ed.q7.displayName;let em="techflow-export-mode";function ex(e){let{value:s,onChange:t,googleSheetsConfigured:r=!1}=e;return(0,a.jsxs)(en.AM,{children:[(0,a.jsx)(en.Wv,{asChild:!0,children:(0,a.jsxs)(h.$,{variant:"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(er.A,{className:"h-4 w-4"}),"Export Settings","manual"!==s&&(0,a.jsx)("span",{className:"ml-1 rounded-full bg-green-100 px-2 py-0.5 text-xs font-medium text-green-700",children:"Auto"})]})}),(0,a.jsx)(en.hl,{className:"w-80",align:"end",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium leading-none",children:"Export Mode"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Choose what happens after approving records"})]}),(0,a.jsxs)(ec,{value:s,onValueChange:e=>t(e),children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3 rounded-lg border p-3 hover:bg-muted/50",children:[(0,a.jsx)(eo,{value:"manual",id:"manual",className:"mt-1"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)(D.J,{htmlFor:"manual",className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)(el.A,{className:"h-4 w-4 text-muted-foreground"}),"Manual Export"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Export dialog opens after batch approve. You choose when to download."})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3 rounded-lg border p-3 hover:bg-muted/50",children:[(0,a.jsx)(eo,{value:"auto-excel",id:"auto-excel",className:"mt-1"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)(D.J,{htmlFor:"auto-excel",className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 text-blue-600"}),"Auto-export to Excel"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Automatically downloads Excel file after approving records."})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3 rounded-lg border p-3 ".concat(r?"hover:bg-muted/50":"opacity-50"),children:[(0,a.jsx)(eo,{value:"auto-sheets",id:"auto-sheets",className:"mt-1",disabled:!r}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)(D.J,{htmlFor:"auto-sheets",className:"flex items-center gap-2 ".concat(r?"cursor-pointer":"cursor-not-allowed"),children:[(0,a.jsx)(o.A,{className:"h-4 w-4 text-green-600"}),"Auto-sync to Google Sheets"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:r?"Automatically syncs to Google Sheets after approving records.":"Requires Google Sheets configuration. Contact admin."})]})]})]}),"manual"!==s&&(0,a.jsxs)("div",{className:"rounded-lg bg-green-50 p-3 text-sm text-green-800",children:[(0,a.jsx)("strong",{children:"Auto-export enabled:"})," Records will be automatically"," ","auto-excel"===s?"downloaded as Excel":"synced to Google Sheets"," ","after approval."]})]})})]})}function eu(){let e=(0,l.useSearchParams)().get("status"),s=(0,i.useTranslations)("records"),t=(0,i.useTranslations)("status"),n=(0,i.useTranslations)("type");(0,i.useTranslations)("export");let u=(0,i.useTranslations)("common"),{toast:f}=(0,G.dj)(),[g,N]=function(){let[e,s]=(0,r.useState)("manual");return(0,r.useEffect)(()=>{let e=localStorage.getItem(em);e&&["manual","auto-excel","auto-sheets"].includes(e)&&s(e)},[]),[e,e=>{s(e),localStorage.setItem(em,e)}]}(),v=(0,$.iL)(),[y,b]=(0,r.useState)({status:e||void 0,limit:100}),[w,C]=(0,r.useState)([]),[A,S]=(0,r.useState)(!1),[E,R]=(0,r.useState)(!1),k=async e=>{if("auto-excel"===g){f({title:"Auto-exporting to Excel...",description:"".concat(e," records approved. Downloading Excel file."),variant:"default"});try{await v.mutateAsync({format:"xlsx",include_rejected:!1}),f({title:"Export Complete!",description:"Excel file downloaded successfully.",variant:"success"})}catch(e){f({title:"Export Failed",description:"Failed to export records. Please try manually.",variant:"destructive"})}}else"auto-sheets"===g?(f({title:"Syncing to Google Sheets...",description:"".concat(e," records approved. Syncing to spreadsheet."),variant:"default"}),R(!0)):(f({title:"Ready to Export!",description:"".concat(e," records approved and ready for export."),variant:"default"}),S(!0))};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h.$,{variant:"ghost",size:"icon",asChild:!0,children:(0,a.jsx)(d(),{href:"/",children:(0,a.jsx)(c.A,{className:"h-4 w-4"})})}),(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:s("title")})]}),(0,a.jsx)("p",{className:"ml-10 text-muted-foreground",children:s("subtitle")})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(ex,{value:g,onChange:N,googleSheetsConfigured:!1}),(0,a.jsxs)(h.$,{variant:"outline",onClick:()=>R(!0),children:[(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Google Sheets"]}),(0,a.jsxs)(h.$,{onClick:()=>S(!0),children:[(0,a.jsx)(m.A,{className:"mr-2 h-4 w-4"}),u("export")]})]})]}),(0,a.jsxs)(p.Zp,{children:[(0,a.jsx)(p.aR,{className:"pb-3",children:(0,a.jsxs)(p.ZB,{className:"flex items-center gap-2 text-base",children:[(0,a.jsx)(x.A,{className:"h-4 w-4"}),s("filters")]})}),(0,a.jsx)(p.Wu,{children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:s("status")}),(0,a.jsxs)(j.l6,{value:y.status||"all",onValueChange:e=>{b(s=>({...s,status:"all"===e?void 0:e}))},children:[(0,a.jsx)(j.bq,{className:"w-[180px]",children:(0,a.jsx)(j.yv,{placeholder:s("allStatuses")})}),(0,a.jsxs)(j.gC,{children:[(0,a.jsx)(j.eb,{value:"all",children:s("allStatuses")}),(0,a.jsx)(j.eb,{value:P.kY.PENDING,children:t("pending")}),(0,a.jsx)(j.eb,{value:P.kY.APPROVED,children:t("approved")}),(0,a.jsx)(j.eb,{value:P.kY.REJECTED,children:t("rejected")}),(0,a.jsx)(j.eb,{value:P.kY.EDITED,children:t("edited")}),(0,a.jsx)(j.eb,{value:P.kY.EXPORTED,children:t("exported")})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:s("type")}),(0,a.jsxs)(j.l6,{value:y.record_type||"all",onValueChange:e=>{b(s=>({...s,record_type:"all"===e?void 0:e}))},children:[(0,a.jsx)(j.bq,{className:"w-[180px]",children:(0,a.jsx)(j.yv,{placeholder:s("allTypes")})}),(0,a.jsxs)(j.gC,{children:[(0,a.jsx)(j.eb,{value:"all",children:s("allTypes")}),(0,a.jsx)(j.eb,{value:P.ee.FORM,children:n("form")}),(0,a.jsx)(j.eb,{value:P.ee.EMAIL,children:n("email")}),(0,a.jsx)(j.eb,{value:P.ee.INVOICE,children:n("invoice")})]})]})]})]})})]}),(0,a.jsx)(J,{selectedIds:w,onComplete:()=>{C([])},onExportPrompt:k}),(0,a.jsx)(O,{filters:y,onSelectionChange:C}),(0,a.jsx)(Z,{isOpen:A,onClose:()=>S(!1),preselectedIds:w.length>0?w:void 0}),(0,a.jsx)(ea,{isOpen:E,onClose:()=>R(!1)})]})}function eh(){return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)(u.A,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading records..."})]})})}function ep(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)(eh,{}),children:(0,a.jsx)(eu,{})})}},46530:(e,s,t)=>{Promise.resolve().then(t.bind(t,35982))},47507:(e,s,t)=>{"use strict";t.d(s,{bq:()=>x,eb:()=>j,gC:()=>p,l6:()=>o,yv:()=>m});var a=t(95155),r=t(12115),l=t(4729),n=t(24033),d=t(12108),i=t(5917),c=t(25016);let o=l.bL;l.YJ;let m=l.WT,x=r.forwardRef((e,s)=>{let{className:t,children:r,...d}=e;return(0,a.jsxs)(l.l9,{ref:s,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...d,children:[r,(0,a.jsx)(l.In,{asChild:!0,children:(0,a.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});x.displayName=l.l9.displayName;let u=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.PP,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})});u.displayName=l.PP.displayName;let h=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.wn,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})});h.displayName=l.wn.displayName;let p=r.forwardRef((e,s)=>{let{className:t,children:r,position:n="popper",...d}=e;return(0,a.jsx)(l.ZL,{children:(0,a.jsxs)(l.UC,{ref:s,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...d,children:[(0,a.jsx)(u,{}),(0,a.jsx)(l.LM,{className:(0,c.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(h,{})]})})});p.displayName=l.UC.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.JU,{ref:s,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=l.JU.displayName;let j=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(l.q7,{ref:s,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(l.VF,{children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})}),(0,a.jsx)(l.p4,{children:r})]})});j.displayName=l.q7.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.wv,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=l.wv.displayName},96633:(e,s,t)=>{"use strict";t.d(s,{A0:()=>d,BF:()=>i,Hj:()=>c,XI:()=>n,nA:()=>m,nd:()=>o});var a=t(95155),r=t(12115),l=t(25016);let n=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:s,className:(0,l.cn)("w-full caption-bottom text-sm",t),...r})})});n.displayName="Table";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("thead",{ref:s,className:(0,l.cn)("[&_tr]:border-b",t),...r})});d.displayName="TableHeader";let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tbody",{ref:s,className:(0,l.cn)("[&_tr:last-child]:border-0",t),...r})});i.displayName="TableBody",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tfoot",{ref:s,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r})}).displayName="TableFooter";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tr",{ref:s,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r})});c.displayName="TableRow";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("th",{ref:s,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...r})});o.displayName="TableHead";let m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("td",{ref:s,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...r})});m.displayName="TableCell",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("caption",{ref:s,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",t),...r})}).displayName="TableCaption"},97450:(e,s,t)=>{"use strict";t.d(s,{AM:()=>d,Wv:()=>i,hl:()=>c});var a=t(95155),r=t(12115),l=t(31138),n=t(25016);let d=l.bL,i=l.l9;l.Mz;let c=r.forwardRef((e,s)=>{let{className:t,align:r="center",sideOffset:d=4,...i}=e;return(0,a.jsx)(l.ZL,{children:(0,a.jsx)(l.UC,{ref:s,align:r,sideOffset:d,className:(0,n.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...i})})});c.displayName=l.UC.displayName}},e=>{e.O(0,[707,704,193,204,305,228,667,100,518,441,255,358],()=>e(e.s=46530)),_N_E=e.O()}]);